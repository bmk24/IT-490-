
/*
let marioWalk_smb1 = new Image();marioWalk_smb1.src = './images/smb1/marioWalk.png';
let marioWalk1_smb1 = new Image();marioWalk1_smb1.src = './images/smb1/marioWalk1.png';
let marioWalk2_smb1 = new Image();marioWalk2_smb1.src = './images/smb1/marioWalk2.png';
let luigiWalk_smb1 = new Image();luigiWalk_smb1.src = './images/smb1/luigiWalk.png';
let luigiWalk1_smb1 = new Image();luigiWalk1_smb1.src = './images/smb1/luigiWalk1.png';
let luigiWalk2_smb1 = new Image();luigiWalk2_smb1.src = './images/smb1/luigiWalk2.png';
let warioWalk_smb1 = new Image();warioWalk_smb1.src = './images/smb1/warioWalk.png';
let warioWalk1_smb1 = new Image();warioWalk1_smb1.src = './images/smb1/warioWalk1.png';
let warioWalk2_smb1 = new Image();warioWalk2_smb1.src = './images/smb1/warioWalk2.png';
let bowserWalk_smb1 = new Image();bowserWalk_smb1.src = './images/smb1/bowserWalk.png';
let bowserWalk1_smb1 = new Image();bowserWalk1_smb1.src = './images/smb1/bowserWalk1.png';
let bowserWalk2_smb1 = new Image();bowserWalk2_smb1.src = './images/smb1/bowserWalk2.png';
*/



marioWalk_smb1.onload,marioWalk1_smb1.onload,marioWalk2_smb1.onload,luigiWalk_smb1.onload,luigiWalk1_smb1.onload,luigiWalk2_smb1.onload,warioWalk_smb1.onload,warioWalk1_smb1.onload,warioWalk2_smb1.onload,bowserWalk_smb1.onload,bowserWalk1_smb1.onload,bowserWalk2_smb1.onload,bowserSMB1_1.onload,bowserSMB1_2.onload,bowserSMB1_3.onload,bowserSMB1_4.onload,bowserSMB1_5.onload,bowserSMB1_6.onload,bowserSMB1_7.onload,bowserSMB1_8.onload,bowserSMB1_9.onload,bowserSMB1_10.onload,bowserSMB1_11.onload,bowserSMB1_12.onload,bowserSMB1_13.onload,bowserSMB1_14.onload,bowserSMB1_15.onload,bowserSMB1_16.onload,bowserSMB1_17.onload,bowserSMB1_18.onload,bowserSMB1_19.onload,bowserSMB1_20.onload,bowserSMB1_21.onload,bowserSMB1_22.onload,bowserSMB1_23.onload,luigiSMB1_1.onload,luigiSMB1_2.onload,luigiSMB1_3.onload,luigiSMB1_4.onload,luigiSMB1_5.onload,luigiSMB1_6.onload,luigiSMB1_7.onload,luigiSMB1_8.onload,luigiSMB1_9.onload,luigiSMB1_10.onload,luigiSMB1_11.onload,luigiSMB1_12.onload,luigiSMB1_13.onload,luigiSMB1_14.onload,luigiSMB1_1_BIG.onload,luigiSMB1_2_BIG.onload,luigiSMB1_3_BIG.onload,luigiSMB1_4_BIG.onload,luigiSMB1_5_BIG.onload,luigiSMB1_6_BIG.onload,luigiSMB1_7_BIG.onload,luigiSMB1_8_BIG.onload,luigiSMB1_9_BIG.onload,luigiSMB1_10_BIG.onload,luigiSMB1_11_BIG.onload,luigiSMB1_12_BIG.onload,luigiSMB1_13_BIG.onload,luigiSMB1_14_BIG.onload,luigiSMB1_15_BIG.onload,luigiSMB1_16_BIG.onload,luigiSMB1_17_BIG.onload,luigiSMB1_18_BIG.onload,luigiSMB1_19_BIG.onload,luigiSMB1_20_BIG.onload,luigiSMB1_21_BIG.onload,marioSMB1_still_BIG.onload,marioSMB1_still_BIGsmall.onload,marioSMB1_swim1.onload,marioSMB1_swim2.onload,marioSMB1_swim3.onload,marioSMB1_swim3_BIG.onload,marioSMB1_swim4.onload,marioSMB1_swim5.onload,marioSMB1_walk2.onload,marioSMB1_walk2_BIG.onload,marioSMB1_walkL1.onload,marioSMB1_walkL1_BIG.onload,marioSMB1_walkL3.onload,marioSMB1_still.onload,marioSMB1_pole.onload,marioSMB1_pole2.onload,marioSMB1_fall.onload,marioSMB1_fall_BIG.onload,marioSMB1_jump1.onload,marioSMB1_duck_BIG.onload,marioSMB1_slide.onload,marioSMB1_slide_BIG.onload,tealMetal_smb1.onload,treePlatform1_smb1.onload,treePlatform2_smb1.onload,treePlatform3_smb1.onload,treePlatformStump_smb1.onload,castleSpike2_smb1.onload,castleSpike2_smb1.onload,castleBrick_smb1.onload,metalBlockTeal_smb1.onload,flagpole_smb1.onload,flagpoleTop_smb1.onload,blackSky_smb1.onload,tealRamp_smb1.onload,tealBlock_smb1.onload,tealPlatform_smb1.onload,seaBlock_smb1.onload,seaPlatform_smb1.onload,seaCoral_smb1.onload,seaWave_smb1.onload,bridgeTop_smb1.onload,bridgeBottom_smb1.onload,largeTreeTop_smb1.onload,largeTreeMid_smb1.onload,largTreeStump_smb1.onload,smallTreeTop_smb1.onload,smallTreeBottom_smb1.onload,grayBlock_smb1.onload,lava_smb1.onload,lavaWave_smb1.onload,castle1_smb1.onload,castle2_smb1.onload,castle3_smb1.onload,castle4_smb1.onload,castle5_smb1.onload,castle6_smb1.onload,castle7_smb1.onload,castle8_smb1.onload,castle9_smb1.onload,castle10_smb1.onload,castle11_smb1.onload,goomba_smb1.onload,mysteryBlock1.onload,mysteryBlock2.onload,tubeMid.onload,bushMid.onload,bushLeft.onload,bushRight.onload,hillTop.onload,hillLeft.onload,hillRight.onload,hillDimple.onload,hillMid.onload,greyMetal.onload,tubeLeft.onload,hillSmall.onload,hillBig.onload,bushSmall.onload,bushMedium.onload,bushLarge.onload,rampBlock.onload,tubeRight.onload,mushroom.onload,platformBlock.onload,metalBlock.onload,mysteryBlock.onload,coinBlock.onload,brickBlock.onload,skyBlock,onload = function(e) {
  console.log("Resources Initialization");


    init();
}
marioWalk_smb1.onerror,marioWalk1_smb1.onerror,marioWalk2_smb1.onerror,luigiWalk_smb1.onerror,luigiWalk1_smb1.onerror,luigiWalk2_smb1.onerror,warioWalk_smb1.onerror,warioWalk1_smb1.onerror,warioWalk2_smb1.onerror,bowserWalk_smb1.onerror,bowserWalk1_smb1.onerror,bowserWalk2_smb1.onerror,bowserSMB1_1.onerror,bowserSMB1_2.onerror,bowserSMB1_3.onerror,bowserSMB1_4.onerror,bowserSMB1_5.onerror,bowserSMB1_6.onerror,bowserSMB1_7.onerror,bowserSMB1_8.onerror,bowserSMB1_9.onerror,bowserSMB1_10.onerror,bowserSMB1_11.onerror,bowserSMB1_12.onerror,bowserSMB1_13.onerror,bowserSMB1_14.onerror,bowserSMB1_15.onerror,bowserSMB1_16.onerror,bowserSMB1_17.onerror,bowserSMB1_18.onerror,bowserSMB1_19.onerror,bowserSMB1_20.onerror,bowserSMB1_21.onerror,bowserSMB1_22.onerror,bowserSMB1_23.onerror,luigiSMB1_1.onerror,luigiSMB1_2.onerror,luigiSMB1_3.onerror,luigiSMB1_4.onerror,luigiSMB1_5.onerror,luigiSMB1_6.onerror,luigiSMB1_7.onerror,luigiSMB1_8.onerror,luigiSMB1_9.onerror,luigiSMB1_10.onerror,luigiSMB1_11.onerror,luigiSMB1_12.onerror,luigiSMB1_13.onerror,luigiSMB1_14.onerror,luigiSMB1_1_BIG.onerror,luigiSMB1_2_BIG.onerror,luigiSMB1_3_BIG.onerror,luigiSMB1_4_BIG.onerror,luigiSMB1_5_BIG.onerror,luigiSMB1_6_BIG.onerror,luigiSMB1_7_BIG.onerror,luigiSMB1_8_BIG.onerror,luigiSMB1_9_BIG.onerror,luigiSMB1_10_BIG.onerror,luigiSMB1_11_BIG.onerror,luigiSMB1_12_BIG.onerror,luigiSMB1_13_BIG.onerror,luigiSMB1_14_BIG.onerror,luigiSMB1_15_BIG.onerror,luigiSMB1_16_BIG.onerror,luigiSMB1_17_BIG.onerror,luigiSMB1_18_BIG.onerror,luigiSMB1_19_BIG.onerror,luigiSMB1_20_BIG.onerror,luigiSMB1_21_BIG.onerror,marioSMB1_still_BIG.onerror,marioSMB1_still_BIGsmall.onerror,marioSMB1_swim1.onerror,marioSMB1_swim2.onerror,marioSMB1_swim3.onerror,marioSMB1_swim3_BIG.onerror,marioSMB1_swim4.onerror,marioSMB1_swim5.onerror,marioSMB1_walk2.onerror,marioSMB1_walk2_BIG.onerror,marioSMB1_walkL1.onerror,marioSMB1_walkL1_BIG.onerror,marioSMB1_walkL3.onerror,marioSMB1_still.onerror,marioSMB1_pole.onerror,marioSMB1_pole2.onerror,marioSMB1_fall.onerror,marioSMB1_fall_BIG.onerror,marioSMB1_jump1.onerror,marioSMB1_duck_BIG.onerror,marioSMB1_slide.onerror,marioSMB1_slide_BIG.onerror,tealMetal_smb1.onerror,treePlatform1_smb1.onerror,treePlatform2_smb1.onerror,treePlatform3_smb1.onerror,treePlatformStump_smb1.onerror,castleSpike2_smb1.onerror,castleSpike2_smb1.onerror,castleBrick_smb1.onerror,metalBlockTeal_smb1.onerror,flagpole_smb1.onerror,flagpoleTop_smb1.onerror,blackSky_smb1.onerror,tealRamp_smb1.onerror,tealBlock_smb1.onerror,tealPlatform_smb1.onerror,seaBlock_smb1.onerror,seaPlatform_smb1.onerror,seaCoral_smb1.onerror,seaWave_smb1.onerror,bridgeTop_smb1.onerror,bridgeBottom_smb1.onerror,largeTreeTop_smb1.onerror,largeTreeMid_smb1.onerror,largTreeStump_smb1.onerror,smallTreeTop_smb1.onerror,smallTreeBottom_smb1.onerror,grayBlock_smb1.onerror,lava_smb1.onerror,lavaWave_smb1.onerror,castle1_smb1.onerror,castle2_smb1.onerror,castle3_smb1.onerror,castle4_smb1.onerror,castle5_smb1.onerror,castle6_smb1.onerror,castle7_smb1.onerror,castle8_smb1.onerror,castle9_smb1.onerror,castle10_smb1.onerror,castle11_smb1.onerror,goomba_smb1.onerror,mysteryBlock1.onerror,mysteryBlock2.onerror,tubeMid.onerror,bushMid.onerror,bushLeft.onerror,bushRight.onerror,hillTop.onerror,hillLeft.onerror,hillRight.onerror,hillDimple.onerror,hillMid.onerror,greyMetal.onerror,tubeLeft.onerror,hillSmall.onerror,hillBig.onerror,bushSmall.onerror,bushMedium.onerror,bushLarge.onerror,rampBlock.onerror,tubeRight.onerror,mushroom.onerror,platformBlock.onerror,metalBlock.onerror,mysteryBlock.onerror,coinBlock.onerror,brickBlock.onerror = function(){
  console.log("Error loading " + this.src); 
}
function init(){
  const currUser = localStorage.getItem('USER');
var res = currUser.toLowerCase();
console.log(res);

getUser(res);
getModifer();

/*************************************************************************************/

//sets username and gets associated user data

/*************************************************************************************/

// If there are any saved items, update our list


canvas  = document.getElementById("game");
context = canvas.getContext('2d');
canvas2  = document.getElementById("gameMid");
context2 = canvas.getContext('2d');
canvasBack  = document.getElementById("gameMid");
contextBack = canvas.getContext('2d');
canvasOverlay  = document.getElementById("gameOverlay");
contextOverlay = canvas.getContext('2d');
canvas.width = 720;
canvas.height = 480;
canvas2.width = 720;
canvas2.height = 480;
canvasBack.width = 720;
canvasBack.height = 480;
canvasOverlay.width = 720;
canvasOverlay.height = 480;
console.log("Canvas Initialization");
console.log("Game Engine Initialization");
/* Setup of the engine */


var game = new Galaxy();
game.setup(map,level_0101);
/* Setup of the engine */


window.requestAnimFrame =
window.requestAnimationFrame ||
window.webkitRequestAnimationFrame ||
window.mozRequestAnimationFrame ||
window.oRequestAnimationFrame ||
window.msRequestAnimationFrame ||
function(callback) { 
return window.setTimeout(callback, 1000 / 60);
};
console.log("Window Animation Initialization");
context2.drawImage(marioWalk1_smb1,20,20);
game.viewPortConstructor(canvas.width, canvas.height,map,level_0101);
game.load_map(map,level_0101);
game.viewPortLim = true;
var Loop = function() {
game.update(map,level_0101);
game.draw(context,map,level_0101);
window.requestAnimFrame(Loop);

};
  Loop();
}
function chkBoxValues () {
  var upgrades = document.getElementsByName('upgrades');
  var checked_uprgades;
  for(i = 0; i < upgrades.length; i++) {
    if(upgrades[i].checked == true) {
      checked_uprgades = upgrades[i].value;
      console.log(checked_uprgades)
    }
  }

}
function getUser(username){
  console.log('Retrieving User Info');
  //let xhr = new XMLHttpRequest();
  let xhr = new XMLHttpRequest();

  var modifier; 
var currency;
var jsonResult;
var head;

head="getUser";
xhr.open("GET", "http://ec2-34-229-47-176.compute-1.amazonaws.com/testApi/getData.php?username="+ username+"&head="+head, false);

xhr.onreadystatechange = function() {
if (this.readyState == 4 && this.status == 200){
    jsonResult=JSON.parse(xhr.responseText);
    console.log(jsonResult.characterName);
    playerStats.spriteType = jsonResult.characterName;

}
};

xhr.onerror = function() {
alert("Request failed");
};
xhr.send();
}
function characterRab(){
    
  let xhr = new XMLHttpRequest();
  var modifier; 
  var currency;
  var jsonResult;
  var head;
  //sets username and gets associated user data
  character="Vario";
  head="getCharacter";
  xhr.open("GET", "getData.php?character="+ character +"&head="+head, true);
  
  
  
  xhr.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200){
        //sent back in form 
        
        jsonResult=JSON.parse(xhr.responseText);
        console.log(jsonResult);
  }
  };
  
  xhr.onerror = function() {
    alert("Request failed");
  };
  xhr.send();
  
  }
  
 
  
  function getModifer(){
      let xhr = new XMLHttpRequest();
  var modifier; 
  var currency;
  var jsonResult;
  var head;
  //sets currency test data
  currency="JPY";
  head="getCurrency";
  xhr.open("GET", "http://ec2-34-229-47-176.compute-1.amazonaws.com/testApi/getData.php?currency="+ currency+"&head="+head, false);
  
  
  
  xhr.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200){
        //sent back in form {'currency':(name),difference:difference in form +-75,20,10 etc}
        jsonResult=JSON.parse(xhr.responseText);
        console.log(jsonResult);
        modifier=jsonResult.difference;
        console.log(modifier);
  }
  };
  
  xhr.onerror = function() {
    alert("Request failed");
  };
  xhr.send();
  }
  
  function getPoints(){
      let xhr = new XMLHttpRequest();
  var modifier; 
  var currency;
  var jsonResult;
  var head;
  //sets username and gets associated user data
  username="user1";
  head="getPoints";
  xhr.open("GET", "getData.php?username="+ username +"&head="+head, true);
  
  
  
  xhr.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200){
        //sent back in form 
        
        jsonResult=JSON.parse(xhr.responseText);
        console.log(jsonResult);
  }
  };
  
  xhr.onerror = function() {
    alert("Request failed");
  };
  xhr.send();
  }
  
  function setChar(){
      let xhr = new XMLHttpRequest();
  var modifier; 
  var currency;
  var jsonResult;
  var head;
  //sets username and gets associated user data
  username="user1";
  head="setCharacter";
  character="Vario";
  xhr.open("GET", "getData.php?username="+ username +"&head="+head+"&character="+character, true);
  
  //nothing sent back since it is a set. Could report success/failure but not worthwhile atm. Tested and does work.
  
  xhr.send();
  }
  
  function setCurr(){
      let xhr = new XMLHttpRequest();
  var modifier; 
  var currency;
  var jsonResult;
  var head;
  //sets username and gets associated user data
  username="user1";
  head="setCurrency";
  currency="RUB";
  xhr.open("GET", "getData.php?username="+ username +"&head="+head+"&currency="+currency, true);
  
  //nothing sent back since it is a set. Could report success/failure but not worthwhile atm. Tested and does work.
  
  xhr.send();
  }
  
  
  function sendInfo(){
  
      let xhr = new XMLHttpRequest();
      var modifier; 
      var currency;
      var jsonResult;
      var head;
      //sets username and gets associated user data
      
      head="setInfo";
      
      username="user1";
      levelsComplete=3;
      currentLevel=5;
      currentPoints=5;
      maxPoints=10;
      spritePack="Bowser";
      character="Vario";
      currency="RUB";
      currentLives=3;
      xhr.open("GET", "getData.php?username="+ username +"&head="+head+"&currency="+currency+ "&levelsComplete="+levelsComplete+
      "&currentLevel="+currentLevel+
      "&currentPoints="+currentPoints+
      "&maxPoints="+maxPoints+
      "&currentLives="+currentLives+
      "&spritePack="+spritePack+
      "&character="+character, true);
      
      //nothing sent back since it is a set. Could report success/failure but not worthwhile atm. Tested and does work.
      
      xhr.send();
  
  }
  
  function setPTs(){
      let xhr = new XMLHttpRequest();
  var modifier; 
  var currency;
  var jsonResult;
  var head;
  //sets username and gets associated user data
  username="user1";
  head="setPoints";
  points=11;
  xhr.open("GET", "getData.php?username="+ username +"&head="+head+"&points="+points, true);
  
  //nothing sent back since it is a set. Could report success/failure but not worthwhile atm. Tested and does work.
  
  xhr.send();
  }